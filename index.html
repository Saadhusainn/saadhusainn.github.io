<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sijjeen - Book Collage Maker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .book-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .book-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .book-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .book-card canvas {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .book-name {
            font-size: 14px;
            color: #333;
            font-weight: bold;
            word-wrap: break-word;
        }
        
        .page-selector {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .page-selector input {
            padding: 10px;
            font-size: 16px;
            border: 2px solid #667eea;
            border-radius: 8px;
            width: 100px;
            text-align: center;
        }
        
        .page-selector button {
            background: #667eea;
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-left: 10px;
            transition: all 0.3s;
        }
        
        .page-selector button:hover {
            background: #764ba2;
        }
        
        .collage-section {
            text-align: center;
        }
        
        .collage-container {
            display: inline-block;
            margin-top: 20px;
        }
        
        .collage-canvas {
            border: 3px solid #667eea;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-width: 100%;
            height: auto;
        }
        
        .download-btn {
            background: #28a745;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .hidden {
            display: none;
        }
        
        .info-text {
            color: #666;
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“š Sijjeen</h1>
        <p class="subtitle">Create beautiful book collages</p>
        
        <h2 style="color: #667eea; margin-bottom: 15px;">Available Books</h2>
        <div id="booksGrid" class="books-grid"></div>
        
        <div id="pageSelector" class="page-selector hidden">
            <h3 style="color: #667eea; margin-bottom: 15px;">Select Page Number</h3>
            <input type="number" id="pageNumber" min="2" value="2" placeholder="Page #">
            <button onclick="createCollage()">Create Collage</button>
            <p class="info-text" id="pageInfo"></p>
        </div>
        
        <div id="collageSection" class="collage-section hidden">
            <h2 style="color: #667eea; margin-bottom: 20px;">Your Collage</h2>
            <div class="collage-container">
                <canvas id="collageCanvas" class="collage-canvas"></canvas>
            </div>
            <br>
            <button class="download-btn" onclick="downloadCollage()">ðŸ’¾ Download Collage</button>
        </div>
    </div>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // ADD YOUR BOOKS HERE - Put your PDF files in a "books" folder
        const booksList = [
            { name: "LETTER PRIVATE", file: "books/musnad Al imam Ahmad vol. 3.pdf" },
            // Add more books like: { name: "Book Name", file: "books/filename.pdf" }
        ];
        
        let books = [];
        let selectedBook = null;
        
        async function loadBooks() {
            for (let bookInfo of booksList) {
                try {
                    const pdf = await pdfjsLib.getDocument(bookInfo.file).promise;
                    books.push({
                        name: bookInfo.name,
                        pdf: pdf,
                        file: bookInfo.file
                    });
                } catch (error) {
                    console.log(`Could not load ${bookInfo.name}`);
                }
            }
            displayBooks();
        }
        
        async function displayBooks() {
            const grid = document.getElementById('booksGrid');
            grid.innerHTML = '';
            
            if (books.length === 0) {
                grid.innerHTML = '<p class="info-text">No books available yet. Upload PDFs to the "books" folder!</p>';
                return;
            }
            
            for (let i = 0; i < books.length; i++) {
                const book = books[i];
                const card = document.createElement('div');
                card.className = 'book-card';
                card.onclick = () => selectBook(i);
                
                const canvas = document.createElement('canvas');
                const page = await book.pdf.getPage(1);
                const viewport = page.getViewport({scale: 0.5});
                
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                
                const context = canvas.getContext('2d');
                await page.render({
                    canvasContext: context,
                    viewport: viewport
                }).promise;
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'book-name';
                nameDiv.textContent = book.name;
                
                card.appendChild(canvas);
                card.appendChild(nameDiv);
                grid.appendChild(card);
            }
        }
        
        function selectBook(index) {
            selectedBook = books[index];
            
            const cards = document.querySelectorAll('.book-card');
            cards.forEach(card => card.classList.remove('selected'));
            cards[index].classList.add('selected');
            
            document.getElementById('pageSelector').classList.remove('hidden');
            document.getElementById('pageInfo').textContent = `Total pages: ${selectedBook.pdf.numPages}`;
            document.getElementById('pageNumber').max = selectedBook.pdf.numPages;
        }
        
        async function createCollage() {
            if (!selectedBook) return;
            
            const pageNum = parseInt(document.getElementById('pageNumber').value);
            
            if (pageNum < 2 || pageNum > selectedBook.pdf.numPages) {
                alert('Please enter a valid page number!');
                return;
            }
            
            const coverPage = await selectedBook.pdf.getPage(1);
            const selectedPage = await selectedBook.pdf.getPage(pageNum);
            
            const scale = 2;
            
            const coverViewport = coverPage.getViewport({scale});
            const pageViewport = selectedPage.getViewport({scale});
            
            const canvas = document.getElementById('collageCanvas');
            const ctx = canvas.getContext('2d');
            
            // Zero padding - pages directly side by side
            canvas.width = coverViewport.width + pageViewport.width;
            canvas.height = Math.max(coverViewport.height, pageViewport.height);
            
            // White background
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Render cover page
            const coverCanvas = document.createElement('canvas');
            coverCanvas.width = coverViewport.width;
            coverCanvas.height = coverViewport.height;
            await coverPage.render({
                canvasContext: coverCanvas.getContext('2d'),
                viewport: coverViewport
            }).promise;
            
            // Render selected page
            const pageCanvas = document.createElement('canvas');
            pageCanvas.width = pageViewport.width;
            pageCanvas.height = pageViewport.height;
            await selectedPage.render({
                canvasContext: pageCanvas.getContext('2d'),
                viewport: pageViewport
            }).promise;
            
            // Draw both pages with ZERO gap
            ctx.drawImage(coverCanvas, 0, 0);
            ctx.drawImage(pageCanvas, coverViewport.width, 0);
            
            document.getElementById('collageSection').classList.remove('hidden');
        }
        
        function downloadCollage() {
            const canvas = document.getElementById('collageCanvas');
            const link = document.createElement('a');
            link.download = 'sijjeen-collage.png';
            link.href = canvas.toDataURL();
            link.click();
        }
        
        // Load books on page load
        loadBooks();
    </script>
</body>
</html>
